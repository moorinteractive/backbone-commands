/*! backbone-commands v0.1.1 24-12-2013, 11:23:03 */
!function(a,b){var c=b.Commands=function(){this._commandMap={}};a.extend(c.prototype,{bind:function(a,b){if("function"==typeof b.execute)throw"invalid command";this._commandMap[a]=b},unbind:function(a){delete this._commandMap[a]},willTrigger:function(a){return this._commandMap[a]||!1},trigger:function(a){var b=Array.prototype.slice.call(arguments,1),c=this._commandMap[a]||null;if(null!==d){var d=new c;d.execute.apply(d,b)}}});var d=b.Command=function(){};a.extend(d.prototype,{execute:function(){}}),b.Command.extend=b.Model.extend;var e=b.MacroCommand=function(){this._subCommands=[],this.initialize.apply(this,arguments)};a.extend(e.prototype,{initialize:function(){},execute:function(){for(;this._subCommands.length;){var a=new(this._subCommands.shift());a.execute.apply(a,arguments)}},addSubCommand:function(a){this._subCommands.push(a)}}),b.MacroCommand.extend=b.Model.extend;var f=b.ASyncCommand=function(){this.onComplete=null};a.extend(f.prototype,{execute:function(){},completeCommand:function(){null!==this.onComplete&&"function"==typeof this.onComplete&&this.onComplete.apply(this.onCompleteContext)}}),b.ASyncCommand.extend=b.Model.extend;var g=b.ASyncMacroCommand=function(){this._args=[],this._subCommands=[],this.onComplete=null,this.onCompleteContext=null,this.initialize.apply(this,arguments)};a.extend(g.prototype,{initialize:function(){},execute:function(){this._args=arguments,this.executeNextCommand()},executeNextCommand:function(){if(this._subCommands.length){var a=new(this._subCommands.shift()),b=void 0!==a.onComplete?!0:!1;b&&(a.onCompleteContext=this,a.onComplete=this.executeNextCommand),a.execute.apply(a,this._args),b||this.executeNextCommand()}else null!==this.onComplete&&"function"==typeof this.onComplete&&this.onComplete.apply(this.onCompleteContext),this.onCompleteContext=null,this.onComplete=null},addSubCommand:function(a){this._subCommands.push(a)}}),b.ASyncMacroCommand.extend=b.Model.extend}(_,Backbone);